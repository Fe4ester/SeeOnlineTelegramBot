from aiogram.types import Message
from src.services.tracker_service_client import SeeOnlineAPI

from src.config.settings import settings

start_text = """
<b>üëã –ü—Ä–∏–≤–µ—Ç! –Ø - –ë–æ—Ç –¥–ª—è —Å–ª–µ–∂–∫–∏</b>

‚ÑπÔ∏è <b>–ö–∞–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è?</b>
‚Ä¢ –î–æ–±–∞–≤—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞
‚Ä¢ –°–º–æ—Ç—Ä–∏ –≥—Ä–∞—Ñ–∏–∫–∏ –æ–Ω–ª–∞–π–Ω–∞

<u>‚ö†Ô∏è –Ø –Ω–∞—Ö–æ–∂—É—Å—å –≤ —Ä–∞–Ω–Ω–µ–º –¥–æ—Å—Ç—É–ø–µ, –≤–æ–∑–º–æ–∂–Ω—ã –æ—à–∏–±–∫–∏</u>

‚úÖ –ï—Å–ª–∏ –æ–±–Ω–∞—Ä—É–∂–∏—à—å –±–∞–≥ –ø–∏—à–∏ –≤ –ø–æ–¥–¥–µ—Ä–∂–∫—É - @seeonline_support

‚ùî <i>–ü–æ–¥—Ä–æ–±–Ω–µ–µ:</i> /help
"""

help_text = """
<b>üîß –ö–∞–∫ —ç—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç?</b>

–Ø —Å–ª–µ–∂—É –∑–∞ –æ–Ω–ª–∞–π–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å–æ—Å—Ç–∞–≤–ª—è—é –≥—Ä–∞—Ñ–∏–∫–∏

<i>‚ÑπÔ∏è –ì—Ä–∞—Ñ–∏–∫ —Å–æ—Å—Ç–∞–≤–ª—è–µ—Ç—Å—è —Å–æ –≤—Ä–µ–º–µ–Ω–µ–º, 
–Ω—É–∂–Ω–æ –ø–æ–¥–æ–∂–¥–∞—Ç—å –ø–æ–∫–∞ —è —Å–æ–±–µ—Ä—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É</i>

<b>üöÄ –ß—Ç–æ —è —É–º–µ—é?</b>
    ‚úÖ –û—Ç–ø—Ä–∞–≤–ª—è—Ç—å –≥—Ä–∞—Ñ–∏–∫–∏ —Å –æ–Ω–ª–∞–π–Ω–æ–º

<b>üìù –ß—Ç–æ –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ –∞–∫—Ç–∏–≤–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ?</b>
    ‚úèÔ∏è –û–ø–æ–≤–µ—â–µ–Ω–∏—è —Å–º–µ–Ω—ã —Å—Ç–∞—Ç—É—Å–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
    ‚úèÔ∏è –ü–µ—Ä–µ—Å–µ—á–µ–Ω–∏—è –æ–Ω–ª–∞–π–Ω–æ–≤ —Ä–∞–∑–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

<i>–î–æ–±–∞–≤–ª—è–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —è –Ω–∞—á–Ω—É —Å–æ—Å—Ç–∞–≤–ª—è—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É!</i>
"""


async def get_menu_text(message: Message):
    async with SeeOnlineAPI(settings.EXTERNAL_SERVICE_API_URL) as api:
        user = await api.get_telegram_user(telegram_id=message.from_user.id)

        role = user[0].role
        tracked_users = f'{user[0].current_users}/{user[0].max_users}'

        menu_text = (
            "<b>üîç –Ø –æ—Ç—Å–ª–µ–∂–∏–≤–∞—é:</b>"
            f"<code>{tracked_users}</code>\n\n"
            ""
            f"<i>üîß [DEBUG] –í–∞—à–∞ —Ä–æ–ª—å: {role}</i>\n\n"
            ""
            "‚ûï –î–æ–±–∞–≤–∏—Ç—å –µ—â—ë?"
        )

        return menu_text
